import * as docx from 'docx';
import file_saver from 'file-saver'
const { saveAs } = file_saver
// Load the full build.
import lodash from 'lodash';
const { _ } =  lodash;
const { TableRow,BorderStyle } = docx;
const { WidthType,Paragraph } = docx;
const { VerticalAlign, Document } = docx;
const { TextRun, AlignmentType } = docx;
const { SectionType, Header } = docx;
const { HeightRule,TableCell } = docx;
const { Footer, LineRuleType } = docx;
const { Table, PageBreak } = docx;
const { HeadingLevel,Packer } = docx;
const arrayPrueba = [
    {nombres: "Luis Carlos"},
]
const generarFilaDatosAlumno = (alumno) => {
    if( alumno != undefined && alumno != null ){
        let filaAlumno = new TableRow({
            children: [
                new TableCell({
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "hola"
                                })
                            ]
                        })
                    ]
                }),
                new TableCell({
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "hola"
                                })
                            ]
                        })
                    ]
                }),
                new TableCell({
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "hola"
                                })
                            ]
                        })
                    ]
                }),
                new TableCell({
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "hola"
                                })
                            ]
                        })
                    ]
                }),
                new TableCell({
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "hola"
                                })
                            ]
                        })
                    ]
                }),
                new TableCell({
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "hola"
                                })
                            ]
                        })
                    ]
                }),
            ]
        });
        return filaAlumno
    }
    return;
}
const generarTablaDatosAlumno = (alumno) => {
    const tabla = new Table({
        width: {
            size: 10000,
            type: WidthType.DXA,
        },
        rows: [
            new TableRow({
                children: [
                    new TableCell({
                        width: {
                            size: 1500,
                            type: WidthType.DXA,
                        },
                        children: [
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Estudiante"
                                    })
                                ]
                            })
                        ]
                    }),
                    new TableCell({
                        width: {
                            size: 1500,
                            type: WidthType.DXA,
                        },
                        children: [
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Cedula"
                                    })
                                ]
                            })
                        ]
                    }),
                    new TableCell({
                        width: {
                            size: 2500,
                            type: WidthType.DXA,
                        },
                        children: [
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Titulo trabajo de grado"
                                    })
                                ]
                            })
                        ]
                    }),
                    new TableCell({
                        width: {
                            size: 1500,
                            type: WidthType.DXA,
                        },
                        children: [
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Tutor"
                                    })
                                ]
                            })
                        ]
                    }),
                    new TableCell({
                        width: {
                            size: 1500,
                            type: WidthType.DXA,
                        },
                        children: [
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Jurado 1 "
                                    })
                                ]
                            })
                        ]
                    }),
                    new TableCell({
                        children: [
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Jurado 2"
                                    })
                                ]
                            })
                        ]
                    }),
                ]
            }),
            generarFilaDatosAlumno(arrayPrueba[0]),
        ]
    })
    return tabla
}
export const notificacion_jurado = (notificacion) => {
    console.log(notificacion)
    const doc = new  Document({
        creator: "Luis C. Somoza & Wladimir San Vicente",
        title: "Carta de notificacion de Jurado - Dirigida a profesor jurado",
        description: "Carta de designaci√≥n - Tutor de propuesta de trabajo de grado experimental",
        styles: {
            default: {
                heading1: {
                    run: {
                        size: 30,
                        bold: true,
                        italics: true,
                        color: "FF0000",
                    },
                    paragraph: {
                        spacing: {
                            after: 200,
                        },
                    },
                },
            },
            paragraphStyles: [
                {
                    id: "aside",
                    name: "Aside",
                    basedOn: "Normal",
                    next: "Normal",
                    run: {
                        size: 20,
                    },
                    paragraph: {
                        spacing: {
                            line: 276,
                        },
                    },
                },
                {
                    id: "despedida",
                    name: "Despedida",
                    basedOn: "Normal",
                    next: "Normal",
                    run: {
                        size: 26,
                    },
                    paragraph: {
                        spacing: {
                            line: 276,
                        },
                    },
                }
            ]
        },
        sections: [{
            properties: {
                type:  SectionType.CONTINUOUS,
                margin: {
                    top: 150,
                    right: 150,
                    bottom: 150,
                    left: 150,
                }
            },
            headers: {
                default: new  Header({
                    children: [new  Paragraph({
                        children: [
                            /*
                            new  ImageRun({
                                data: fs.readFileSync('logo.png'),
                                transformation: {
                                    width: 400,
                                    height: 100,
                                },
                            }),
                            */
                        ],
                        alignment:  AlignmentType.LEFT
                    })],
                }),
            },
            footers: {
                default: new  Footer({
                    children: [
                        new  Paragraph({
                            children: [
                                /*
                                new  ImageRun({
                                    data: fs.readFileSync('Untitled.png'),
                                    transformation: {
                                        width: 600,
                                        height: 15,
                                    },
                                    alignment:  AlignmentType.CENTER
                                }),
                                */
                            ],
                            alignment:  AlignmentType.CENTER
                        }),
                        new  Paragraph({
                            children: [
                                new  TextRun({
                                    text: "UNIVERSIDAD CAT√ìLICA ANDR√âS BELLO ‚Äì Extensi√≥n Guayana",
                                })
                            ],
                            alignment:  AlignmentType.CENTER
                        }),
                        new  Paragraph({
                            children: [
                                new  TextRun({
                                    text: "Avenida Atl√°ntico, Ciudad Guayana 8050",
                                })
                            ],
                            alignment:  AlignmentType.CENTER
                        }),
                        new  Paragraph({
                            children: [
                                new  TextRun({
                                    text: "Bol√≠var, Venezuela. Tel√©fono: +58-286-6000111"
                                })
                            ],
                            alignment:  AlignmentType.CENTER
                        }),
                        new  Paragraph({
                            children: [
                                new  TextRun({
                                    text: "URL: http://www.guayanaweb.ucab.edu.ve/escuela-de-ingenieria-informatica.html"
                                })
                            ],
                            alignment:  AlignmentType.CENTER
                        })
                    ],
                }),
            },
            children: [
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "Inserte la fecha aqui"
                        })
                    ],
                    alignment: AlignmentType.RIGHT
                }),
                /*Generar funcion para imprimir estudiantes aqui*/
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "Profesor: [Inserte datos de profesor aqui]"
                        })
                    ],
                    alignment: AlignmentType.JUSTIFIED
                }),
                new Paragraph({
                    children: [
                        new TextRun({
                            text: `Me es grato dirigirme a Usted en oportunidad de informarle que en Consejo de Escuela N¬∞ [Inserte consejo de escuela aqui] de [Inserte fecha de CDE aqui], han sido designados los siguientes jurados para la revisi√≥n y evaluaci√≥n de su Trabajo de Grado:`
                        })
                    ],
                    alignment: AlignmentType.JUSTIFIED
                }),
                generarTablaDatosAlumno(),
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "El jurado ya dispone del Informe del Trabajo de Grado para su revisi√≥n, as√≠ como de las planillas relativas a la evaluaci√≥n del Trabajo de Grado. "
                        })
                    ]
                }),
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "La presentaci√≥n oral ser√° fijada para la segunda semana del mes de noviembre 2022, de acuerdo a la disponibilidad de los participantes. Posteriormente se le informar√° el lugar, fecha y hora de la misma. "
                        })
                    ]
                }),
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "A continuaci√≥n, le indico un resumen de la din√°mica de actividades y responsabilidades para la presentaci√≥n oral de su trabajo de grado"
                        })
                    ]
                }),
                new Paragraph({
                    bullet: {
                        level: 0
                    },
                    children: [
                        new TextRun({
                            text: "Debe tener listo el material de apoyo de la presentaci√≥n de su Trabajo de Grado, debidamente revisada por su tutor acad√©mico."
                        })
                    ]
                }),
                new Paragraph({
                    bullet: {
                        level: 0
                    },
                    children: [
                        new TextRun({
                            text: "El Art√≠culo 12 del Reglamento del Trabajo de Grado de la Facultad de Ingenier√≠a (No. 9.01.08, del 19 de julio de 2018), establece que ‚ÄúLa presentaci√≥n oral del TG ser√° un acto privado; si alguna persona ajena al Jurado Examinador desea presenciar el acto, deber√° solicitar ante √©l su aprobaci√≥n‚Äù, en caso de que el(los) tesista(s) desee tener invitados debe solicitarlo a trav√©s del correo lmedinac@ucab.edu.ve: indicando nombre completo, n√∫mero de c√©dula y filiaci√≥n o motivo de su presencia en la presentaci√≥n del Trabajo de Grado."
                        })
                    ]
                }),
                new Paragraph({
                    bullet: {
                        level: 0
                    },
                    children: [
                        new TextRun({
                            text: "El d√≠a de la presentaci√≥n oral:"
                        })
                    ]
                }),
                new Paragraph({
                    bullet: {
                        level: 1
                    },
                    children: [
                        new TextRun({
                            text: "Estar preparados al menos una hora antes de la hora de inicio de la Presentaci√≥n."
                        })
                    ]
                }),
                new Paragraph({
                    bullet: {
                        level: 1
                    },
                    children: [
                        new TextRun({
                            text: "Verificar el correcto funcionamiento de los equipos de apoyo de la Presentaci√≥n y tener un plan alternativo de apoyo, en caso de que falle el principal en el momento de la exposici√≥n."
                        })
                    ]
                }),
                new Paragraph({
                    bullet: {
                        level: 1
                    },
                    children: [
                        new TextRun({
                            text: "Se recomienda para la presentaci√≥n vestir ropa formal."
                        })
                    ]
                }),
                new Paragraph({
                    bullet: {
                        level: 1
                    },
                    children: [
                        new TextRun({
                            text: "El Coordinador de Trabajos de Grado o el Presidente del Jurado, indicar√° verbalmente a los asistentes las normas respectivas, en cuanto a la no participaci√≥n ni interrupci√≥n de la Presentaci√≥n por parte de familiares y amigos, y que su presencia estar√° limitada a presenciar la presentaci√≥n Oral, no en la sesi√≥n de preguntas ni en la parte del acto correspondiente a la deliberaci√≥n, en la cual todos los presentes, incluyendo los alumnos que realizan la presentaci√≥n, deben salir del recinto para que el Jurado pueda dar inicio al proceso de deliberaci√≥n y evaluaci√≥n del Trabajo de Grado. "
                        })
                    ]
                }),
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "Salud√°ndole cordialmente"
                        })
                    ]
                }),
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "Atentamente,"
                        })
                    ]
                }),
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "Luz E. Medina C"
                        })
                    ]
                }),
            ]
        }]
    });
    const nombre_archivo = "Notificacion de designacion de jurado"
    let archivo = null;
    Packer.toBlob(doc).then( blob => {
         saveAs(blob, nombre_archivo+".docx");
        //console.log("Documento creado de forma exitosa en el navegador");
    });
}

